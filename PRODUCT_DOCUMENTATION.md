# AI 자세교정 웹 애플리케이션 - 프로덕트 문서

## 📋 프로젝트 개요

### 🎯 **개발 목표**

- 웹캠을 통한 실시간 자세 감지 및 교정
- 사용자 친화적인 자세 분석 및 피드백 제공
- 의료진과의 상담을 위한 데이터 내보내기 기능
- 자세 개선 추이를 시각적으로 분석
- 다국어 지원 (한국어, 영어, 일본어)

### 🚀 **배포 정보**

- **현재 배포**: Vercel - https://posture-check-app.vercel.app/

## 🛠 기술 스택

### Frontend

- **React 19.1.0** - 사용자 인터페이스 구축
- **Vite 6.3.5** - 빠른 개발 환경 및 빌드 도구
- **Styled-components 6.1.19** - CSS-in-JS 스타일링
- **Zustand 5.0.5** - 상태 관리
- **MediaPipe Pose 0.5.1675469404** - 실시간 인체 포즈 감지
- **Recharts** - 데이터 시각화
- **jsPDF 3.0.1** - PDF 생성
- **jspdf-autotable 5.0.2** - PDF 테이블 생성
- **XLSX 0.18.5** - 엑셀 파일 생성
- **react-i18next** - 다국어 지원

### Backend (예정)

- **FastAPI** - 백엔드 API

## 📁 프로젝트 구조

```
src/
├── assets/          # 이미지, 폰트 등 정적 파일
├── components/      # 재사용 가능한 컴포넌트
│   ├── charts/     # 차트 컴포넌트
│   ├── common/     # 공통 컴포넌트 (언어 선택기, 달력 등)
│   ├── dataexport/ # 데이터 내보내기 컴포넌트
│   └── history/    # 히스토리 테이블 컴포넌트
├── hooks/          # 커스텀 훅
├── i18n/           # 다국어 설정
├── pages/          # 페이지 컴포넌트
├── store/          # Zustand 스토어
├── styles/         # 전역 스타일 및 테마
└── utils/          # 유틸리티 함수
```

## 🔍 주요 기능

### 1. 실시간 자세 감지

- **MediaPipe Pose** 기반 실시간 인체 포즈 감지
- 웹캠을 통한 실시간 자세 분석
- 33개 랜드마크 포인트 추적
- 자세 점수 실시간 계산 및 피드백

### 2. 자세 분석 지표

- **목 각도 (Neck Angle)**: -45°~45° 범위
- **어깨 기울기 (Shoulder Slope)**: -10°~10° 범위
- **머리 전진 (Head Forward)**: ≤15% 범위
- **어깨 높이 차이 (Shoulder Height Diff)**: ≤8% 범위
- **경추 전만 (Cervical Lordosis)**: -30°~30° 범위
- **전방 머리 거리 (Forward Head Distance)**: ≤100mm
- **머리 기울기 (Head Tilt)**: -15°~15° 범위
- **머리 회전 (Head Rotation)**: ≤15° 범위
- **견갑골 날개 (Scapular Winging)**: 좌우 개별 감지
- **어깨 전방 이동 (Shoulder Forward Movement)**: ≤150mm

### 3. 데이터 시각화

- **점수 추이 차트**: 시간별 자세 점수 변화
- **자세 분포 파이 차트**: 완벽/좋음/보통/나쁨 비율
- **지표별 메트릭 차트**: 각 분석 지표의 변화 추이

### 4. 데이터 관리

- **로컬 스토리지**: 브라우저 기반 데이터 저장
- **필터링**: 기간별, 상태별 데이터 필터링
- **페이지네이션**: 대용량 데이터 효율적 표시

### 5. 데이터 내보내기

- **CSV 내보내기**: 엑셀 호환 데이터 형식
- **PDF 내보내기**: 한글 폰트 지원 리포트 생성
- **통계 정보 포함**: 평균 점수, 개선도, 일관성 등

### 6. 다국어 지원

- **한국어 (ko)**: 기본 언어
- **영어 (en)**: 국제 사용자 지원
- **일본어 (ja)**: 일본 사용자 지원

## 📊 자세 점수 시스템

### 점수 계산 방식

- **90점 이상**: 완벽한 자세
- **60-89점**: 좋은 자세
- **50-59점**: 보통 자세
- **50점 미만**: 나쁜 자세

### 점수 영향 요소

- 각 지표별 정상 범위 이탈 정도
- 지표별 가중치 적용
- 실시간 보정 및 평활화

## 🎨 UI/UX 설계

### 디자인 원칙

- **직관적 사용성**: 복잡한 기술을 간단한 인터페이스로
- **실시간 피드백**: 즉시적인 자세 교정 가이드
- **데이터 투명성**: 모든 측정 결과 공개
- **접근성**: 다양한 사용자 환경 지원

### 주요 화면

1. **홈 화면**: 앱 소개 및 기능 안내
2. **자세 감지 화면**: 실시간 웹캠 분석
3. **데이터 화면**: 통계 및 차트 시각화
4. **히스토리 화면**: 과거 데이터 조회

## 🔧 개발 과정

### 1단계: 기획 및 설계

- 자세 분석 알고리즘 연구
- UI/UX 와이어프레임 작성
- 기술 스택 선정

### 2단계: 핵심 기능 개발

- MediaPipe Pose 통합
- 자세 분석 알고리즘 구현
- 실시간 피드백 시스템 구축

### 3단계: 데이터 관리

- 로컬 스토리지 시스템 구축
- 데이터 시각화 컴포넌트 개발
- 필터링 및 검색 기능 구현

### 4단계: 내보내기 기능

- CSV 내보내기 구현
- PDF 생성 시스템 개발
- 한글 폰트 지원 추가

### 5단계: 다국어 지원

- i18next 설정
- 번역 파일 작성
- 언어 전환 기능 구현

## 🚨 트러블슈팅 내역

### 1. PDF 내보내기 오류 (해결됨)

**문제**: 배포 환경에서 PDF 추출 시 `Uncaught (in promise) TypeError: i is not a function` 오류 발생

**원인**:

- `PostureData.jsx`에서 `exportPDF` 함수 호출 시 매개변수 전달 방식 오류
- 함수가 객체 형태의 매개변수를 받도록 정의되었으나 개별 매개변수로 전달

**해결 방법**:

```javascript
// 수정 전
exportPDF(filteredHistory, stats, startDate, endDate, t, i18n.language);

// 수정 후
exportPDF({
  filteredHistory,
  stats,
  t,
  getScoreStatus,
  formatDate,
  language: i18n.language,
});
```

**추가 개선사항**:

- 폰트 로딩 실패 시 기본 폰트 사용하는 fallback 추가
- `window.btoa` 함수 오류 처리 강화
- 전체 함수에 try-catch 블록 추가
- 사용자 친화적인 오류 메시지 표시

### 2. MediaPipe 라이브러리 로딩 최적화

**문제**: 초기 로딩 시 MediaPipe 라이브러리 로드 지연

**해결 방법**:

- 동적 import를 통한 코드 스플리팅
- 로딩 상태 표시 추가
- 에러 핸들링 강화

### 3. 한글 폰트 지원

**문제**: PDF 생성 시 한글 깨짐 현상

**해결 방법**:

- NotoSansKR 폰트 파일 추가
- Base64 인코딩을 통한 폰트 임베딩
- 폰트 로딩 실패 시 fallback 처리

### 4. 성능 최적화

**문제**: 대용량 데이터 처리 시 성능 저하

**해결 방법**:

- 가상화된 테이블 구현
- 페이지네이션 적용
- 메모이제이션을 통한 불필요한 재계산 방지

### 5. 웹캠 권한 및 HTTPS 문제

**문제**:

- HTTP 환경에서 웹캠 접근 불가
- 브라우저별 웹캠 권한 요청 차이
- 일부 브라우저에서 MediaPipe 작동 안함

**해결 방법**:

- HTTPS 환경 강제 적용
- 웹캠 권한 요청 전 사용자 안내 추가
- 브라우저 호환성 체크 및 폴백 구현
- 권한 거부 시 대안 UI 제공

### 6. React 19 호환성 문제

**문제**:

- React 19 업그레이드 후 일부 훅 동작 변경
- useEffect 의존성 배열 경고 증가
- useCallback 최적화 이슈

**해결 방법**:

- 모든 useEffect 의존성 배열 검토 및 수정
- useCallback 함수들의 의존성 최적화
- React 19 린트 규칙 적용
- 불필요한 리렌더링 방지

### 7. API 연결 및 CORS 문제

**문제**:

- 배포 환경에서 백엔드 연결 실패
- CORS 정책 위반 오류
- 환경 변수 설정 누락

**해결 방법**:

- 다중 백엔드 URL 지원 (fallback 시스템)
- CORS 설정 가이드 문서화
- 환경 변수 검증 로직 추가
- 연결 상태 모니터링 시스템 구현

### 8. 빌드 최적화 및 번들 크기

**문제**:

- 초기 번들 크기 과대 (MediaPipe 라이브러리 포함)
- 빌드 시간 지연
- 청크 분할 최적화 필요

**해결 방법**:

- Vite 설정에서 수동 청크 분할 구현
- MediaPipe 라이브러리 동적 로딩
- 코드 스플리팅 적용
- 번들 분석 도구 활용

### 9. 다국어 지원 구현 문제

**문제**:

- i18next 설정 복잡성
- 동적 번역 키 처리
- 언어 변경 시 상태 관리

**해결 방법**:

- i18next 설정 모듈화
- 번역 키 네임스페이스 체계화
- 언어 변경 시 컴포넌트 리렌더링 최적화
- 누락된 번역 키 감지 시스템

### 10. 데이터 저장 및 동기화

**문제**:

- 로컬 스토리지 용량 제한
- 데이터 형식 호환성 문제
- 백엔드 연동 시 데이터 변환 오류

**해결 방법**:

- 데이터 압축 및 최적화
- 데이터 마이그레이션 시스템 구현
- 백엔드-프론트엔드 데이터 형식 통일
- 오프라인 데이터 동기화 메커니즘

### 11. 차트 라이브러리 성능 문제

**문제**:

- Recharts 라이브러리 로딩 지연
- 대용량 데이터 렌더링 성능 저하
- 반응형 차트 구현 복잡성

**해결 방법**:

- Recharts 동적 로딩 구현
- 데이터 샘플링 및 가상화
- 차트 컴포넌트 메모이제이션
- 성능 모니터링 추가

### 12. 배포 환경 설정 문제

**문제**:

- Vercel 환경 변수 설정 복잡성
- 빌드 시 환경별 설정 분기
- CDN 캐싱 문제

**해결 방법**:

- 환경 변수 검증 시스템 구현
- 빌드 스크립트 최적화
- 캐시 무효화 전략 수립
- 배포 후 검증 자동화

### 13. 메모리 누수 및 성능 이슈

**문제**:

- MediaPipe 인스턴스 정리 누락
- 애니메이션 프레임 누적
- 이벤트 리스너 정리 부족

**해결 방법**:

- 컴포넌트 언마운트 시 정리 로직 강화
- requestAnimationFrame 관리 개선
- 메모리 사용량 모니터링 추가
- 성능 프로파일링 도구 활용

### 14. 사용자 경험 개선

**문제**:

- 로딩 상태 표시 부족
- 에러 메시지 불명확
- 접근성 문제

**해결 방법**:

- 전역 로딩 상태 관리 시스템
- 사용자 친화적 에러 메시지
- ARIA 라벨 및 키보드 네비게이션 추가
- 사용자 피드백 시스템 구현

## 📈 성능 지표

### 로딩 성능

- **초기 로딩 시간**: < 3초
- **자세 감지 시작**: < 2초
- **PDF 생성 시간**: < 5초

### 메모리 사용량

- **기본 사용량**: ~50MB
- **자세 감지 중**: ~80MB
- **대용량 데이터 처리**: ~120MB

## 🔮 향후 개발 계획

### 단기 계획 (1-2개월)

- [ ] 백엔드 API 연동
- [ ] 사용자 인증 시스템
- [ ] 클라우드 데이터 저장
- [ ] 모바일 반응형 개선

### 중기 계획 (3-6개월)

- [ ] AI 기반 자세 개선 추천
- [ ] 운동 프로그램 연동
- [ ] 의료진 상담 시스템
- [ ] 소셜 기능 (친구와 비교)

### 장기 계획 (6개월 이상)

- [ ] 모바일 앱 개발
- [ ] 웨어러블 디바이스 연동
- [ ] 의료 기관 파트너십
- [ ] 상용화 및 수익화

## 🛡️ 보안 고려사항

### 현재 구현된 보안

- 클라이언트 사이드 데이터 처리
- 로컬 스토리지 기반 데이터 저장
- 웹캠 권한 요청 처리

### 향후 보안 계획

- HTTPS 강제 적용
- 사용자 데이터 암호화
- API 인증 및 권한 관리
- GDPR 준수

## 📚 참고 자료

### 기술 문서

- [MediaPipe Pose Documentation](https://google.github.io/mediapipe/solutions/pose)
- [jsPDF Documentation](https://artskydj.github.io/jsPDF/docs/)
- [React i18next Documentation](https://react.i18next.com/)

### 연구 자료

- 자세 분석 관련 의학 논문
- 인체공학적 자세 기준
- 물리치료 가이드라인

## 👥 팀 정보

### 개발자

- **역할**: 풀스택 개발자
- **담당**: 프론트엔드 개발, UI/UX 설계, 백엔드 설계

### 협업

- **디자이너**: UI/UX 디자인 검토
- **의료진**: 자세 분석 기준 검증
- **테스터**: 사용성 테스트 및 피드백

---

**문서 버전**: 1.0  
**최종 업데이트**: 2024년 12월  
**다음 검토 예정**: 2025년 1월
